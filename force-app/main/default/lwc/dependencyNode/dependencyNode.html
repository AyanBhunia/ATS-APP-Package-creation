<template>
    <div class="dependency-node-card slds-box slds-theme_default slds-m-bottom_small" data-relationship-type={node.relationshipType}>
        <div class="dependency-node-header slds-grid slds-grid_align-spread slds-grid_vertical-align-center">
            <div class="slds-grid slds-grid_vertical-align-center slds-gutters_small">
                <div class="slds-col">
                    <lightning-input 
                        type="radio" 
                        name="nodeSelection"
                        data-node-id={nodeId}
                        checked={isNodeSelected}
                        onchange={handleNodeSelection}>
                    </lightning-input>
                </div>
                <div class="slds-col">
                    <span class="slds-text-heading_small slds-text-color_default">
                        {node.objectName}
                    </span>
                </div>
                <div class="slds-col">
                    <span class="slds-text-body_regular slds-text-color_weak">=</span>
                </div>
                <div class="slds-col">
                    <span class="slds-text-body_regular slds-text-color_default">
                        {node.fieldName}
                    </span>
                </div>
                <div class="slds-col">
                    <lightning-combobox
                        data-node-id={nodeId}
                        value={fieldType}
                        options={fieldTypeOptions}
                        onchange={handleFieldTypeChange}
                        variant="label-hidden">
                    </lightning-combobox>
                </div>
            </div>
            <div class="slds-col slds-no-flex">
                <span class="slds-badge slds-badge_lightest">
                    {node.relationshipType}
                </span>
            </div>
        </div>
        
        <!-- Child Nodes -->
        <template if:true={hasChildren}>
            <div class="dependency-children slds-p-left_medium slds-m-top_small">
                <template for:each={node.parents} for:item="child">
                    <c-dependency-node 
                        key={child.objectName}
                        node={child}
                        depth={childDepth}
                        node-selection-handler={nodeSelectionHandler}
                        field-type-change-handler={fieldTypeChangeHandler}
                        is-node-selected={isNodeSelected}
                        get-node-field-type={getNodeFieldType}
                        generate-node-id={generateNodeId}
                        field-type-options={fieldTypeOptions}>
                    </c-dependency-node>
                </template>
            </div>
        </template>
    </div>
</template>